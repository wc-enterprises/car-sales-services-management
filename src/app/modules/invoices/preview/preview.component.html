<!-- Title and action buttons -->
<div
  class="absolute pl-10 mobile-small:pl-7 pr-7 pt-2 pb-2 flex items-center justify-between w-full bg-gray-200 print:hidden"
  *ngIf="invoiceData"
>
  <div>
    <div
      class="text-3xl mobile-small:text-base font-semibold tracking-tight leading-8"
    >
      Invoice {{ invoiceData.invoiceNumber }}
    </div>
  </div>
  <div class="flex items-center ml-6">
    <button
      class="sm:inline-flex ml-3"
      mat-flat-buttonz
      [color]="'primary'"
      (click)="exportInvoice()"
    >
      <mat-icon
        class="icon-size-5 mobile-small:icon-size-4"
        [svgIcon]="'heroicons_solid:arrow-up-tray'"
      ></mat-icon>
      <span class="ml-2 mobile-small:text-sm">Export</span>
    </button>
  </div>
</div>

<div
  class="minify absolute inset-0 min-w-0 mt-15 text-center print:overflow-visible lg:h-full md:h-full lg:overflow-hidden md:overflow-hidden print:scale-100"
  cdkScrollable
>
  <!-- Main -->
  <div
    *ngIf="invoiceData"
    class="inline-block p-6 mobile-small:pl-8 sm:p-10 text-left xl:overflow-y-scroll lg:overflow-y-scroll lg:h-full md:overflow-y-scroll md:h-full hide-scrollbar"
  >
    <!-- A4 -->
    <div class="rounded-2xl shadow print:rounded-none print:overflow-visible">
      <!-- Header -->
      <img
        *ngIf="invoiceData.type === 'SERVICE'"
        src="assets/images/invoice/invoice-header.svg"
        alt="header"
      />
      <img
        *ngIf="invoiceData.type === 'SALE'"
        src="assets/images/invoice/grace-cars-ltd-header.svg"
        alt="header"
      />
      <!-- Content -->
      <div class="w-240 pl-16 pr-16">
        <!-- Head content -->
        <div class="flex items-start justify-between">
          <div class="grid grid-cols-2 gap-x-4 gap-y-1">
            <div class="text-4xl tracking-tight text-secondary">INVOICE</div>
            <div class="text-4xl">{{ invoiceData.invoiceNumber }}</div>
            <div class="font-medium tracking-tight text-secondary">
              INVOICE DATE
            </div>
            <div class="font-medium">{{ formatDate(invoiceData.date) }}</div>
            <div class="font-medium tracking-tight text-secondary">
              TOTAL DUE
            </div>
            <div class="font-medium">
              {{ invoiceData.total | currency : "GBP" }}
            </div>
          </div>
          <div
            class="grid auto-cols-max grid-flow-col gap-x-8 -mr-16 py-6 px-8 rounded-l-2xl"
          >
            <div class="place-self-center w-24">
              <img class="w-24" src="assets/images/logo/logo.svg" />
            </div>
            <div class="pl-10 border-l text-md">
              <div class="font-medium">Grace Auto Service</div>
              <div>78 Main Road</div>
              <div>Highbridge, TA9, 3QX</div>
              <div>+44 7574 173450</div>
              <div>+44 1278 470492</div>
              <div>info&#64;graceautoservice.co.uk</div>
              <div>www.graceautoservice.co.uk</div>
            </div>
          </div>
        </div>

        <!-- Customer Data -->
        <div class="text-md">
          <div class="text-xl font-medium">{{ invoiceData.billTo.name }}</div>
          <div class="max-w-60">
            {{
              formatAddress(
                invoiceData.billTo.addressLine1,
                invoiceData.billTo.addressLine2,
                invoiceData.billTo.city,
                invoiceData.billTo.country,
                invoiceData.billTo.postalCode
              )
            }}
          </div>
          <div>{{ formatNumber(invoiceData.billTo.phoneNumber) }}</div>
        </div>

        <!-- Table Columns -->
        <div
          class="grid grid-cols-12 gap-x-1 mt-12 bg-[#1E5482] h-[50px] include-color-head rounded-[5px]"
        >
          <!-- First Column -->
          <div
            class="col-span-8 font-medium text-md text-secondary text-white pl-4"
            *ngIf="invoiceData.type === 'SERVICE'"
          >
            SERVICE
          </div>
          <div
            class="col-span-3 font-medium text-md text-secondary text-white pl-4"
            *ngIf="invoiceData.type === 'SALE'"
          >
            MAKE
          </div>

          <!-- Second Column -->
          <div
            class="font-medium text-md text-right text-secondary text-white"
            *ngIf="invoiceData.type === 'SERVICE'"
          >
            RATE
          </div>
          <div
            class="col-span-5 font-medium text-md text-secondary text-white"
            *ngIf="invoiceData.type === 'SALE'"
          >
            MODEL
          </div>

          <!-- Third Column -->
          <div
            class="font-medium text-md text-right text-secondary text-white"
            *ngIf="invoiceData.type === 'SERVICE'"
          >
            QTY
          </div>
          <div
            class="col-span-2 font-medium text-md text-right text-secondary text-white"
            *ngIf="invoiceData.type === 'SALE'"
          >
            REG NO
          </div>

          <!-- Fourth Column -->
          <div
            class="col-span-2 font-medium text-md text-right text-secondary pr-4 text-white"
            *ngIf="invoiceData.type === 'SERVICE'"
          >
            TOTAL
          </div>
          <div
            class="col-span-2 font-medium text-md text-right text-secondary pr-4 text-white"
            *ngIf="invoiceData.type === 'SALE'"
          >
            PRICE
          </div>
        </div>

        <!-- Table Data-->
        <div class="grid grid-cols-12 gap-x-1">
          <ng-container
            *ngFor="let service of invoiceData.services; let i = index"
          >
            <!-- Spacer if above first row -->
            <div class="col-span-12 my-4" *ngIf="i === 0"></div>
            <!-- Divider -->
            <div class="col-span-12 my-4 border-b" *ngIf="i !== 0"></div>

            <!-- Column 1 Item -->
            <div
              class="col-span-8 text-lg font-medium pl-3"
              *ngIf="invoiceData.type === 'SERVICE'"
            >
              {{ service.item }}
            </div>
            <div
              class="col-span-3 text-lg font-medium pl-3"
              *ngIf="invoiceData.type === 'SALE'"
            >
              {{ service.id }}
            </div>

            <!-- Column 2 Item -->
            <div
              class="self-center text-right"
              *ngIf="invoiceData.type === 'SERVICE'"
            >
              {{ service.price | currency : "GBP" }}
            </div>
            <div
              class="col-span-5 self-center"
              *ngIf="invoiceData.type === 'SALE'"
            >
              {{ service.item }}
            </div>

            <!-- Column 3 Item -->
            <div
              class="self-center text-right"
              *ngIf="invoiceData.type === 'SERVICE'"
            >
              {{ service.quantity }}
            </div>
            <div
              class="col-span-2 self-center text-right"
              *ngIf="invoiceData.type === 'SALE'"
            >
              {{ service.total }}
            </div>

            <!-- Column 4 Item -->
            <div
              class="col-span-2 self-center text-right pr-3"
              *ngIf="invoiceData.type === 'SERVICE'"
            >
              {{
                getTotalPerItem(service.price, service.quantity)
                  | currency : "GBP"
              }}
            </div>
            <div
              class="col-span-2 self-center text-right pr-3"
              *ngIf="invoiceData.type === 'SALE'"
            >
              {{ service.price | currency : "GBP" }}
            </div>
          </ng-container>

          <!-- Spacer -->
          <div class="col-span-12 mt-16"></div>

          <!-- Subtotal -->
          <div
            class="col-span-10 self-center font-medium tracking-tight text-secondary pl-3"
          >
            SUBTOTAL
          </div>
          <div class="col-span-2 text-right text-lg pr-3">
            {{ invoiceData.subtotal | currency : "GBP" }}
          </div>

          <!-- Divider -->
          <div class="col-span-12 my-3 border-b"></div>

          <!-- Tax -->
          <div
            class="col-span-10 self-center font-medium tracking-tight text-secondary pl-3"
          >
            TAX
          </div>
          <div class="col-span-2 text-right text-lg pr-3">
            {{ invoiceData.tax?.value | currency : "GBP" }}
          </div>

          <!-- Divider -->
          <div class="col-span-12 my-3 border-b"></div>

          <!-- Discount -->
          <div
            class="col-span-10 self-center font-medium tracking-tight text-secondary pl-3"
          >
            DISCOUNT
          </div>
          <div class="col-span-2 text-right text-lg pr-3">
            {{ invoiceData.discount?.value | currency : "GBP" }}
          </div>

          <!-- Divider -->
          <div class="col-span-12 my-3 border-b"></div>
        </div>

        <div class="grid grid-cols-12 h-[50px] pt-4">
          <!-- Total -->
          <div class="col-span-8 self-center"></div>
          <div
            class="col-span-4 bg-[#1E5482] flex justify-between include-color rounded-[5px]"
          >
            <div
              class="self-center text-xl font-medium tracking-tight text-secondary h-[35px] text-white pl-2"
            >
              TOTAL
            </div>
            <div
              class="text-right text-xl font-medium text-white h-[35px] pr-2"
            >
              {{ invoiceData.total | currency : "GBP" }}
            </div>
          </div>
        </div>

        <div class="mt-16">
          <div class="font-medium">
            Please pay within 15 days. Thank you for your business.
          </div>
        </div>
      </div>
      <!-- Footer -->
      <img src="assets/images/invoice/grace-footer.svg" alt="footer" />
    </div>
  </div>
</div>
